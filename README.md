# Тестовое задание для компании HardQode

## Задание
Построение системы для обучения. Спроектировать базу: создать сущность продукта, доступа к продукту, урока, просмотра урока. Реализовать API для: выведения всех уроков, к которым пользователь имеет доступ, выведения списка уроков по конкретному продукту, отображения статистики по всем продуктам. Суть задания заключается в проверке знаний построения связей в БД и умение правильно строить запросы без ошибок N+1.
 

## Решение
В решении использованы Django и DjangoRestFramework. Созданы 4 модели для сущностей, между ними созданы связи. С помощью класса APIView реализованы 3 необходимых endpoint-а. Оптимизированы запросы к БД, каждый endpoint посылает всего 1 запрос в базу, для этого использованы annotate и Subquery.

## API endpoints
**api/v1/lessons/** 

Получение списка всех уроков, к которым текущий пользователь имеет доступ, с указанием статуса и времени просмотра

**api/v1/products/id/lessons/** 

Получение списка всех уроков конкретного продукта, к которому пользователь имеет доступ, с указанием статуса просмотра, времени и даты

**api/v1/products/statistics/** 

Подробная статистика по всем продуктам, которая содержит:
- Количество просмотренных уроков от всех учеников.
- Сколько в сумме все ученики потратили времени на просмотр роликов.
- Количество учеников занимающихся на продукте.
- Процент приобретения продукта (рассчитывается исходя из количества полученных доступов к продукту деленное на общее количество пользователей на платформе).

## Запус приложения

Сначала в корне проекта создадим виртуальное окружение и активируем его:
```
python3 -m venv venv
source venv/bin/activate
```
Затем установим все зависимости проекта, отдав следующую команду:
```
pip install -r requirements.txt
```
Затем в корне проекта отдаем следующие команды, применяя миграции к базе данных:
```
python3 manage.py migrate
```
После этого можно запускать сервер следующей командой:
```
python3 manage.py runserver
```
Приложение запуститься и должно быть доступно по локальному адресу [127.0.0.1:8000](http://127.0.0.1:8000)